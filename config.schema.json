{
  "pluginAlias": "TasmotaZbBridge",
  "pluginType": "platform",
  "singular": true,
  "schema": {
    "type": "object",
    "properties": {
      "name": {
        "title": "Name",
        "type": "string",
        "placeholder": "Homebridge name for the TasmotaZbBridge platform",
        "required": true,
        "default": "ZbBridge"
      },
      "mqttTopic": {
        "title": "MQTT Topic",
        "type": "string",
        "placeholder": "Identifying topic of your ZbBridge device (i.e. tasmota_ABCDEF)",
        "required": true
      },
      "zbBridgeDevices": {
        "title": "ZbBridge Devices",
        "expandable": true,
        "expanded": false,
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "id": {
              "title": "ID",
              "type": "string",
              "placeholder": "Device ID in hex (i.e. 0x1234)",
              "pattern": "^0x[A-Fa-f0-9]{4}$",
              "required": true
            },
            "type": {
              "title": "Type",
              "type": "string",
              "default": "light1",
              "oneOf": [{
                "title": "Simple On/Off Light",
                "enum": ["light0"]
              }, {
                "title": "White Light with Dimmer",
                "enum": ["light1"]
              }, {
                "title": "White Light with Dimmer and Cold/Warm White",
                "enum": ["light2"]
              }, {
                "title": "RGB Light",
                "enum": ["light3"]
              }, {
                "title": "On/Off Switch",
                "enum": ["switch"]
              }],
              "required": true
            },
            "name": {
              "title": "Name",
              "placeholder": "Name shown in the Home app",
              "type": "string",
              "required": true
            }
          }
        }
      },
      "tasmotaDevices": {
        "title": "Tasmota Devices",
        "expandable": true,
        "expanded": false,
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "topic": {
              "title": "MQTT Topic",
              "type": "string",
              "required": true
            },
            "type": {
              "title": "Type",
              "type": "string",
              "default": "switch",
              "oneOf": [{
                "title": "Basic Switch",
                "enum": ["POWER"]
              }, {
                "title": "4CH Switch 1",
                "enum": ["POWER1"]
              }, {
                "title": "4CH Switch 2",
                "enum": ["POWER2"]
              }, {
                "title": "4CH Switch 3",
                "enum": ["POWER3"]
              }, {
                "title": "4CH Switch 4",
                "enum": ["POWER4"]
              }, {
                "title": "AM2301 Temperature",
                "enum": ["StatusSNS.AM2301.Temperature"]
              }, {
                "title": "AM2301 Humidity",
                "enum": ["StatusSNS.AM2301.Humidity"]
              }],
              "required": true
            },
            "name": {
              "title": "Name",
              "type": "string",
              "placeholder": "Name shown in the Home app",
              "required": true
            }
          }
        }
      },
      "mqttBroker": {
        "title": "Hostname",
        "type": "string",
        "placeholder": "Broker hostname if not localhost",
        "format": "hostname"
      },
      "mqttUsername": {
        "title": "Username",
        "type": "string",
        "placeholder": "Broker username if passwort protected",
        "format": "password"
      },
      "mqttPassword": {
        "title": "Password",
        "placeholder": "Broker passwort if passwort protected",
        "type": "string",
        "format": "password"
      }
    }
  },
  "layout": [{
      "key": "name"
    },
    {
      "key": "mqttTopic"
    },
    {
      "key": "zbBridgeDevices",
      "buttonText": "Add Device",
      "items": [{
        "type": "div",
        "displayFlex": false,
        "items": [{
          "type": "flex",
          "flex-flow": "row wrap",
          "items": [{
              "type": "flex",
              "flex": "1 1 90px",
              "flex-flow": "column",
              "items": ["zbBridgeDevices[].id"]
            },
            {
              "type": "flex",
              "flex": "1 1 150px",
              "flex-flow": "column",
              "items": ["zbBridgeDevices[].type"]
            },
            {
              "type": "flex",
              "flex-flow": "column",
              "items": ["zbBridgeDevices[].name"]
            }
          ]
        }]
      }]
    },
    {
      "key": "tasmotaDevices",
      "buttonText": "Add Device",
      "items": [{
        "type": "div",
        "displayFlex": false,
        "items": [{
          "type": "flex",
          "flex-flow": "row wrap",
          "items": [{
              "type": "flex",
              "flex": "1 1 90px",
              "flex-flow": "column",
              "items": ["tasmotaDevices[].topic"]
            },
            {
              "type": "flex",
              "flex": "1 1 150px",
              "flex-flow": "column",
              "items": ["tasmotaDevices[].type"]
            },
            {
              "type": "flex",
              "flex-flow": "column",
              "items": ["tasmotaDevices[].name"]
            }
          ]
        }]
      }]
    },
    {
      "type": "fieldset",
      "title": "MQTT Settings",
      "expandable": true,
      "expanded": false,
      "items": [
        "mqttBroker",
        {
          "type": "div",
          "displayFlex": false,
          "items": [{
            "type": "flex",
            "flex-flow": "row wrap",
            "items": [{
              "type": "flex",
              "flex-flow": "column",
              "items": ["mqttUsername"]
            }, {
              "type": "flex",
              "flex-flow": "column",
              "items": ["mqttPassword"]
            }]
          }]
        }
      ]
    }
  ]
}